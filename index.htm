<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Street Cricket Scorer</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    function App() {
      const saved = JSON.parse(localStorage.getItem("match"));

      const [screen, setScreen] = React.useState(saved ? "scoring" : "setup");

      const [teamA, setTeamA] = React.useState(saved?.teamA || "Team A");
      const [teamB, setTeamB] = React.useState(saved?.teamB || "Team B");

      const [squadA, setSquadA] = React.useState(saved?.squadA || ["","",""]);
      const [squadB, setSquadB] = React.useState(saved?.squadB || ["","",""]);

      const [tossWinner, setTossWinner] = React.useState(saved?.tossWinner || "");
      const [tossChoice, setTossChoice] = React.useState(saved?.tossChoice || "");

      const [striker, setStriker] = React.useState(saved?.striker || "");
      const [nonStriker, setNonStriker] = React.useState(saved?.nonStriker || "");
      const [bowler, setBowler] = React.useState(saved?.bowler || "");

      const [runs, setRuns] = React.useState(saved?.runs || 0);
      const [wickets] = React.useState(saved?.wickets || 0);
      const [balls, setBalls] = React.useState(saved?.balls || 0);

      const [day, setDay] = React.useState(saved?.day || 1);
      const [dayEnded, setDayEnded] = React.useState(saved?.dayEnded || false);

      const overs = `${Math.floor(balls/6)}.${balls%6}`;

      function save() {
        localStorage.setItem("match", JSON.stringify({
          teamA, teamB, squadA, squadB,
          tossWinner, tossChoice,
          striker, nonStriker, bowler,
          runs, wickets, balls,
          day, dayEnded
        }));
      }

      function swapStrike() {
        setStriker(nonStriker);
        setNonStriker(striker);
      }

      function scoreRun(r) {
        if (dayEnded) return;
        setRuns(runs + r);
        setBalls(balls + 1);
        if (r % 2 === 1) swapStrike();
        if ((balls + 1) % 6 === 0) swapStrike();
        setTimeout(save, 0);
      }

      /* ================= SETUP SCREEN ================= */
      function Setup() {
        const ready =
          squadA.every(p=>p) &&
          squadB.every(p=>p) &&
          tossWinner &&
          tossChoice;

        return (
          <div className="max-w-xl mx-auto p-4 space-y-4">
            <h1 className="text-2xl font-bold text-center">Start Match</h1>

            <input className="w-full border p-2" value={teamA} onChange={e=>setTeamA(e.target.value)} placeholder="Team A" />
            <input className="w-full border p-2" value={teamB} onChange={e=>setTeamB(e.target.value)} placeholder="Team B" />

            <h3 className="font-semibold">Team A Players</h3>
            {squadA.map((p,i)=>(
              <input key={i} className="w-full border p-2 mb-1"
                value={p}
                onChange={e=>{const c=[...squadA];c[i]=e.target.value;setSquadA(c);}}
                placeholder={`Player ${i+1}`} />
            ))}

            <h3 className="font-semibold">Team B Players</h3>
            {squadB.map((p,i)=>(
              <input key={i} className="w-full border p-2 mb-1"
                value={p}
                onChange={e=>{const c=[...squadB];c[i]=e.target.value;setSquadB(c);}}
                placeholder={`Player ${i+1}`} />
            ))}

            <div>
              <p className="font-medium">Toss Winner</p>
              {[teamA, teamB].map(t=>(
                <button key={t}
                  onClick={()=>setTossWinner(t)}
                  className={`px-3 py-2 mr-2 border ${tossWinner===t?"bg-teal-600 text-white":""}`}>
                  {t}
                </button>
              ))}
            </div>

            <div>
              <p className="font-medium">Toss Choice</p>
              {["Bat","Bowl"].map(c=>(
                <button key={c}
                  onClick={()=>setTossChoice(c)}
                  className={`px-3 py-2 mr-2 border ${tossChoice===c?"bg-teal-600 text-white":""}`}>
                  {c}
                </button>
              ))}
            </div>

            <button
              disabled={!ready}
              onClick={()=>{
                setStriker(squadA[0]);
                setNonStriker(squadA[1]);
                setBowler(squadB[0]);
                save();
                setScreen("scoring");
              }}
              className={`w-full py-3 font-semibold ${ready?"bg-teal-600 text-white":"bg-gray-300"}`}>
              Start Match
            </button>
          </div>
        );
      }

      /* ================= SCORING SCREEN ================= */
      function Scoring() {
        return (
          <div className="min-h-screen bg-black text-white">
            <div className="bg-red-600 p-3 text-center font-semibold">
              {teamA} vs {teamB}
            </div>

            <div className="p-6 text-center bg-gray-900">
              <h2 className="text-4xl font-bold">
                Day {day} ¬∑ {runs}/{wickets} ({overs})
              </h2>
              <p className="text-sm text-gray-400 mt-2">
                {tossWinner} chose to {tossChoice.toLowerCase()}
              </p>
            </div>

            <div className="bg-gray-800 p-3 flex justify-between">
              <span className="text-green-400">üèè {striker}</span>
              <span>{nonStriker}</span>
              <span>{bowler}</span>
            </div>

            <div className="grid grid-cols-3 bg-white text-black">
              {[0,1,2,3,4,6].map(r=>(
                <button key={r} onClick={()=>scoreRun(r)}
                  className="py-6 border font-semibold">
                  {r===4?"FOUR":r===6?"SIX":r}
                </button>
              ))}
            </div>

            {!dayEnded ? (
              <button onClick={()=>{setDayEnded(true);save();}}
                className="w-full py-3 bg-yellow-500 text-black font-semibold">
                End Day
              </button>
            ) : (
              <button onClick={()=>{setDay(day+1);setDayEnded(false);save();}}
                className="w-full py-3 bg-green-600 text-white font-semibold">
                Start Day {day+1}
              </button>
            )}
          </div>
        );
      }

      return screen==="setup" ? <Setup/> : <Scoring/>;
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
