<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Street Cricket Scorer</title>

  <link rel="manifest" href="manifest.json" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    function App() {
      /* ===== APP FLOW ===== */
      const [screen, setScreen] = React.useState("setup");

      /* ===== TEAM SETUP ===== */
      const [teamAName, setTeamAName] = React.useState("Team A");
      const [teamBName, setTeamBName] = React.useState("Team B");

      const [teamASquad, setTeamASquad] = React.useState(["", "", ""]);
      const [teamBSquad, setTeamBSquad] = React.useState(["", "", ""]);

      const [tossWinner, setTossWinner] = React.useState("");
      const [tossChoice, setTossChoice] = React.useState("");

      /* ===== MATCH STATE ===== */
      const [striker, setStriker] = React.useState("");
      const [nonStriker, setNonStriker] = React.useState("");
      const [bowler, setBowler] = React.useState("");

      const [runs, setRuns] = React.useState(0);
      const [wickets, setWickets] = React.useState(0);
      const [balls, setBalls] = React.useState(0);

      /* ===== DAY STATE ===== */
      const [day, setDay] = React.useState(1);
      const [dayEnded, setDayEnded] = React.useState(false);

      const overs = `${Math.floor(balls / 6)}.${balls % 6}`;

      /* ===== SAVE / RESTORE ===== */
      React.useEffect(() => {
        const saved = JSON.parse(localStorage.getItem("matchProgress"));
        if (saved) {
          Object.entries(saved).forEach(([k, v]) => eval(`set${k.charAt(0).toUpperCase()+k.slice(1)}(v)`));
          setScreen("scoring");
        }
      }, []);

      function saveProgress() {
        localStorage.setItem(
          "matchProgress",
          JSON.stringify({
            teamAName,
            teamBName,
            teamASquad,
            teamBSquad,
            tossWinner,
            tossChoice,
            striker,
            nonStriker,
            bowler,
            runs,
            wickets,
            balls,
            day,
            dayEnded
          })
        );
      }

      function swapStrike() {
        setStriker(nonStriker);
        setNonStriker(striker);
      }

      /* ===== SETUP SCREEN ===== */
      function SetupScreen() {
        const canStart =
          teamASquad.every(p => p) &&
          teamBSquad.every(p => p) &&
          tossWinner &&
          tossChoice;

        return (
          <div className="max-w-xl mx-auto p-4 space-y-4">
            <h1 className="text-2xl font-bold text-center">Start Match</h1>

            <input className="w-full border p-2 rounded" value={teamAName} onChange={e => setTeamAName(e.target.value)} placeholder="Team A Name" />
            <input className="w-full border p-2 rounded" value={teamBName} onChange={e => setTeamBName(e.target.value)} placeholder="Team B Name" />

            <h3 className="font-semibold">Team A Players</h3>
            {teamASquad.map((p,i)=>(
              <input key={i} className="w-full border p-2 rounded mb-1" value={p}
                onChange={e=>{const c=[...teamASquad];c[i]=e.target.value;setTeamASquad(c);}}
                placeholder={`Player ${i+1}`} />
            ))}

            <h3 className="font-semibold">Team B Players</h3>
            {teamBSquad.map((p,i)=>(
              <input key={i} className="w-full border p-2 rounded mb-1" value={p}
                onChange={e=>{const c=[...teamBSquad];c[i]=e.target.value;setTeamBSquad(c);}}
                placeholder={`Player ${i+1}`} />
            ))}

            <div>
              <p className="font-medium">Toss Winner</p>
              {[teamAName, teamBName].map(t=>(
                <button key={t} onClick={()=>setTossWinner(t)}
                  className={`px-3 py-2 mr-2 border rounded ${tossWinner===t?"bg-teal-600 text-white":""}`}>
                  {t}
                </button>
              ))}
            </div>

            <div>
              <p className="font-medium">Toss Choice</p>
              {["Bat","Bowl"].map(c=>(
                <button key={c} onClick={()=>setTossChoice(c)}
                  className={`px-3 py-2 mr-2 border rounded ${tossChoice===c?"bg-teal-600 text-white":""}`}>
                  {c}
                </button>
              ))}
            </div>

            <button
              disabled={!canStart}
              onClick={()=>{
                setStriker(teamASquad[0]);
                setNonStriker(teamASquad[1]);
                setBowler(teamBSquad[0]);
                saveProgress();
                setScreen("scoring");
              }}
              className={`w-full py-3 font-semibold ${canStart?"bg-teal-600 text-white":"bg-gray-300 text-gray-500"}`}>
              Start Match
            </button>
          </div>
        );
      }

      /* ===== SCORING SCREEN ===== */
      function ScoringScreen() {
        function scoreRun(r) {
          if (dayEnded) return;
          setRuns(runs + r);
          setBalls(balls + 1);
          if (r % 2 === 1) swapStrike();
          if ((balls + 1) % 6 === 0) swapStrike();
          saveProgress();
        }

        return (
          <div className="min-h-screen bg-black text-white">
            <div className="bg-red-600 p-3 text-center font-semibold">
              {teamAName} vs {teamBName}
            </div>

            <div className="p-6 text-center bg-gray-900">
              <h2 className="text-4xl font-bold">
                Day {day} ¬∑ {runs}/{wickets} ({overs})
              </h2>
              <p className="text-sm text-gray-400 mt-2">
                {tossWinner} won the toss and chose to {tossChoice.toLowerCase()}
              </p>
            </div>

            <div className="bg-gray-800 p-3 flex justify-between">
              <span className="text-green-400">üèè {striker}</span>
              <span>{nonStriker}</span>
              <span>{bowler}</span>
            </div>

            <div className="grid grid-cols-3 bg-white text-black">
              {[0,1,2,3,4,6].map(r=>(
                <button key={r} onClick={()=>scoreRun(r)}
                  className="py-6 border font-semibold">
                  {r===4?"FOUR":r===6?"SIX":r}
                </button>
              ))}
            </div>

            {!dayEnded ? (
              <button onClick={()=>{setDayEnded(true);saveProgress();}}
                className="w-full py-3 bg-yellow-500 text-black font-semibold">
                End Day
              </button>
            ) : (
              <button onClick={()=>{setDay(day+1);setDayEnded(false);saveProgress();}}
                className="w-full py-3 bg-green-600 text-white font-semibold">
                Start Day {day+1}
              </button>
            )}
          </div>
        );
      }

      return screen==="setup" ? <SetupScreen/> : <ScoringScreen/>;
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
