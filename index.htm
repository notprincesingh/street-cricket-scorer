<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Street Cricket Scorer</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body class="bg-gray-200">
<div id="root"></div>

<script type="text/babel">
function App() {
  /* ===== SETUP ===== */
  const [screen, setScreen] = React.useState("setup");

  const [teamA, setTeamA] = React.useState("Team A");
  const [teamB, setTeamB] = React.useState("Team B");
  const [squadA, setSquadA] = React.useState(["","",""]);
  const [squadB, setSquadB] = React.useState(["","",""]);

  /* ===== TOSS ===== */
  const [tossWinner, setTossWinner] = React.useState(null);
  const [tossDecision, setTossDecision] = React.useState(null);

  /* ===== PLAYERS ===== */
  const [battingTeam, setBattingTeam] = React.useState(null);
  const [bowlingTeam, setBowlingTeam] = React.useState(null);

  const [striker, setStriker] = React.useState("");
  const [nonStriker, setNonStriker] = React.useState("");
  const [bowler, setBowler] = React.useState("");

  /* ===== MATCH ===== */
  const [runs, setRuns] = React.useState(0);
  const [balls, setBalls] = React.useState(0);
  const [wickets, setWickets] = React.useState(0);

  /* ===== MODALS ===== */
  const [showWicket, setShowWicket] = React.useState(false);
  const [wicketType, setWicketType] = React.useState(null);

  const overs = `${Math.floor(balls/6)}.${balls%6}`;

  function doToss() {
    const winner = Math.random() < 0.5 ? teamA : teamB;
    setTossWinner(winner);
  }

  function decide(choice) {
    setTossDecision(choice);
    if (choice === "Bat") {
      setBattingTeam(tossWinner);
      setBowlingTeam(tossWinner === teamA ? teamB : teamA);
    } else {
      setBattingTeam(tossWinner === teamA ? teamB : teamA);
      setBowlingTeam(tossWinner);
    }
  }

  function startMatch() {
    setScreen("scoring");
  }

  function scoreRun(r) {
    setRuns(runs + r);
    setBalls(balls + 1);
    if (r % 2 === 1) {
      setStriker(nonStriker);
      setNonStriker(striker);
    }
  }

  function recordWicket(detail) {
    setWickets(wickets + 1);
    setBalls(balls + 1);
    alert(`Wicket: ${detail}`);
    setStriker("New Batsman");
    setShowWicket(false);
  }

  /* ===== SETUP SCREEN ===== */
  if (screen === "setup") {
    return (
      <div className="min-h-screen flex justify-center">
        <div className="w-full max-w-md bg-white p-4 space-y-4">

          <h1 className="text-xl font-bold text-center">Match Setup</h1>

          <input className="border p-2 w-full" value={teamA} onChange={e=>setTeamA(e.target.value)} />
          {squadA.map((p,i)=>(
            <input key={i} className="border p-2 w-full"
              placeholder={`Team A Player ${i+1}`}
              value={p}
              onChange={e=>{
                const c=[...squadA]; c[i]=e.target.value; setSquadA(c);
              }} />
          ))}

          <input className="border p-2 w-full" value={teamB} onChange={e=>setTeamB(e.target.value)} />
          {squadB.map((p,i)=>(
            <input key={i} className="border p-2 w-full"
              placeholder={`Team B Player ${i+1}`}
              value={p}
              onChange={e=>{
                const c=[...squadB]; c[i]=e.target.value; setSquadB(c);
              }} />
          ))}

          {!tossWinner && (
            <button onClick={doToss}
              className="w-full bg-blue-600 text-white py-2">
              Toss
            </button>
          )}

          {tossWinner && !tossDecision && (
            <div>
              <p className="text-center font-semibold mb-2">
                {tossWinner} won the toss
              </p>
              <button onClick={()=>decide("Bat")}
                className="w-full bg-green-600 text-white py-2 mb-2">
                Bat
              </button>
              <button onClick={()=>decide("Bowl")}
                className="w-full bg-red-600 text-white py-2">
                Bowl
              </button>
            </div>
          )}

          {battingTeam && (
            <div className="space-y-2">
              <select className="border p-2 w-full" onChange={e=>setStriker(e.target.value)}>
                <option>Select Striker</option>
                {(battingTeam===teamA?squadA:squadB).map(p=>(
                  <option key={p}>{p}</option>
                ))}
              </select>

              <select className="border p-2 w-full" onChange={e=>setNonStriker(e.target.value)}>
                <option>Select Non-Striker</option>
                {(battingTeam===teamA?squadA:squadB).filter(p=>p!==striker).map(p=>(
                  <option key={p}>{p}</option>
                ))}
              </select>

              <select className="border p-2 w-full" onChange={e=>setBowler(e.target.value)}>
                <option>Select Bowler</option>
                {(bowlingTeam===teamA?squadA:squadB).map(p=>(
                  <option key={p}>{p}</option>
                ))}
              </select>

              <button onClick={startMatch}
                className="w-full bg-teal-600 text-white py-2">
                Start Match
              </button>
            </div>
          )}

        </div>
      </div>
    );
  }

  /* ===== SCORING ===== */
  return (
    <div className="min-h-screen bg-black text-white flex justify-center">
      <div className="w-full max-w-md">

        <div className="bg-red-600 p-3 text-center">
          {battingTeam} Batting
        </div>

        <div className="p-4 text-center bg-gray-900">
          <h2 className="text-4xl">{runs}/{wickets}</h2>
          <p className="text-sm">Overs {overs}</p>
        </div>

        <div className="bg-gray-800 p-3 flex justify-between">
          <span className="text-green-400">üèè {striker}</span>
          <span>{nonStriker}</span>
          <span>üéØ {bowler}</span>
        </div>

        <div className="grid grid-cols-3 bg-white text-black">
          {[0,1,2,3,4,6].map(r=>(
            <button key={r} onClick={()=>scoreRun(r)}
              className="py-6 border text-xl font-bold">
              {r===4?"FOUR":r===6?"SIX":r}
            </button>
          ))}
          <button onClick={()=>setShowWicket(true)}
            className="py-6 border bg-red-500 text-white">
            OUT
          </button>
        </div>

        {showWicket && (
          <div className="fixed inset-0 bg-black/70 flex items-center justify-center">
            <div className="bg-white p-4 space-y-2 text-black">
              <button onClick={()=>recordWicket("Bowled")}
                className="w-full border py-2">Bowled</button>
              <button onClick={()=>setWicketType("Caught")}
                className="w-full border py-2">Caught</button>
              <button onClick={()=>setWicketType("Run Out")}
                className="w-full border py-2">Run Out</button>

              {wicketType && (
                <select className="border p-2 w-full"
                  onChange={e=>recordWicket(`${wicketType} by ${e.target.value}`)}>
                  <option>Select Fielder</option>
                  {(bowlingTeam===teamA?squadA:squadB).filter(
                    p=>p!==bowler
                  ).map(p=>(
                    <option key={p}>{p}</option>
                  ))}
                </select>
              )}
            </div>
          </div>
        )}

      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
